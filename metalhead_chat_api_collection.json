{
  "info": {
    "name": "Metalhead Chat API",
    "description": "Chat API for confirmed jobs between employers and helpers",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "jwt_token",
      "value": "YOUR_JWT_TOKEN_HERE",
      "type": "string"
    },
    {
      "key": "conversation_id",
      "value": "cmfnrg40s0001ihlwhr6lefab",
      "type": "string"
    },
    {
      "key": "job_id",
      "value": "YOUR_CONFIRMED_JOB_ID",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Conversation Management",
      "item": [
        {
          "name": "Create Conversation from Job",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"job_id\": \"{{job_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/chat/conversation/from-job",
              "host": ["{{base_url}}"],
              "path": ["chat", "conversation", "from-job"]
            },
            "description": "Create or get conversation for a confirmed job between employer and helper"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"job_id\": \"cmfmgajnj0000ihq0zjovmzp1\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/chat/conversation/from-job",
                  "host": ["{{base_url}}"],
                  "path": ["chat", "conversation", "from-job"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Conversation created\",\n  \"data\": {\n    \"id\": \"cmfnrg40s0001ihlwhr6lefab\",\n    \"creator_id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n    \"participant_id\": \"cmfg9trmy0002ihd8ifha67n2\",\n    \"created_at\": \"2025-09-17T09:09:28.541Z\",\n    \"updated_at\": \"2025-09-17T09:09:28.541Z\",\n    \"creator\": {\n      \"id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n      \"name\": \"John Doe\",\n      \"avatar\": \"avatar1.jpg\",\n      \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar1.jpg\"\n    },\n    \"participant\": {\n      \"id\": \"cmfg9trmy0002ihd8ifha67n2\",\n      \"name\": \"Jane Helper\",\n      \"avatar\": \"avatar2.jpg\",\n      \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar2.jpg\"\n    }\n  }\n}"
            }
          ]
        },
        {
          "name": "Create Direct Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"creator_id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n  \"participant_id\": \"cmfg9trmy0002ihd8ifha67n2\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/chat/conversation",
              "host": ["{{base_url}}"],
              "path": ["chat", "conversation"]
            },
            "description": "Create conversation directly between two users (note: message sending still requires confirmed job)"
          }
        },
        {
          "name": "Get All Conversations",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/chat/conversation",
              "host": ["{{base_url}}"],
              "path": ["chat", "conversation"]
            },
            "description": "Get all conversations for the authenticated user"
          }
        },
        {
          "name": "Get Conversation by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/chat/conversation/{{conversation_id}}",
              "host": ["{{base_url}}"],
              "path": ["chat", "conversation", "{{conversation_id}}"]
            },
            "description": "Get specific conversation details"
          }
        }
      ]
    },
    {
      "name": "Message Management",
      "item": [
        {
          "name": "Send Text Message",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"conversation_id\": \"{{conversation_id}}\",\n  \"receiver_id\": \"cmfg9trmy0002ihd8ifha67n2\",\n  \"message\": \"Hello! Ready to start working on this job?\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/chat/message",
              "host": ["{{base_url}}"],
              "path": ["chat", "message"]
            },
            "description": "Send a text message in a conversation"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [
                  {
                    "key": "Content-Type",
                    "value": "application/json"
                  }
                ],
                "body": {
                  "mode": "raw",
                  "raw": "{\n  \"conversation_id\": \"cmfnrg40s0001ihlwhr6lefab\",\n  \"receiver_id\": \"cmfg9trmy0002ihd8ifha67n2\",\n  \"message\": \"Hello! Ready to start working on this job?\"\n}"
                },
                "url": {
                  "raw": "{{base_url}}/chat/message",
                  "host": ["{{base_url}}"],
                  "path": ["chat", "message"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Message sent successfully\"\n}"
            }
          ]
        },
        {
          "name": "Send Image Message",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/image.jpg",
                  "description": "Image file to send"
                },
                {
                  "key": "conversation_id",
                  "value": "{{conversation_id}}",
                  "type": "text"
                },
                {
                  "key": "receiver_id",
                  "value": "cmfg9trmy0002ihd8ifha67n2",
                  "type": "text"
                },
                {
                  "key": "name",
                  "value": "screenshot.jpg",
                  "type": "text"
                },
                {
                  "key": "type",
                  "value": "image/jpeg",
                  "type": "text"
                },
                {
                  "key": "message",
                  "value": "Here's the reference image for the job",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/chat/message/upload",
              "host": ["{{base_url}}"],
              "path": ["chat", "message", "upload"]
            },
            "description": "Send an image attachment message"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "POST",
                "header": [],
                "body": {
                  "mode": "formdata",
                  "formdata": [
                    {
                      "key": "file",
                      "type": "file",
                      "src": "/path/to/image.jpg"
                    },
                    {
                      "key": "conversation_id",
                      "value": "cmfnrg40s0001ihlwhr6lefab",
                      "type": "text"
                    },
                    {
                      "key": "receiver_id",
                      "value": "cmfg9trmy0002ihd8ifha67n2",
                      "type": "text"
                    },
                    {
                      "key": "name",
                      "value": "screenshot.jpg",
                      "type": "text"
                    },
                    {
                      "key": "type",
                      "value": "image/jpeg",
                      "type": "text"
                    },
                    {
                      "key": "message",
                      "value": "Here's the reference image for the job",
                      "type": "text"
                    }
                  ]
                },
                "url": {
                  "raw": "{{base_url}}/chat/message/upload",
                  "host": ["{{base_url}}"],
                  "path": ["chat", "message", "upload"]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"message\": \"Attachment sent\",\n  \"data\": {\n    \"id\": \"msg_123\",\n    \"conversation_id\": \"cmfnrg40s0001ihlwhr6lefab\",\n    \"sender_id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n    \"receiver_id\": \"cmfg9trmy0002ihd8ifha67n2\",\n    \"message\": \"Here's the reference image for the job\",\n    \"attachment_id\": \"att_456\",\n    \"status\": \"SENT\",\n    \"created_at\": \"2025-09-17T09:15:30.000Z\"\n  }\n}"
            }
          ]
        },
        {
          "name": "Send Voice Message",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "file",
                  "type": "file",
                  "src": "/path/to/voice.webm",
                  "description": "Voice recording file (webm, mp3, wav, etc.)"
                },
                {
                  "key": "conversation_id",
                  "value": "{{conversation_id}}",
                  "type": "text"
                },
                {
                  "key": "receiver_id",
                  "value": "cmfg9trmy0002ihd8ifha67n2",
                  "type": "text"
                },
                {
                  "key": "name",
                  "value": "voice_message.webm",
                  "type": "text"
                },
                {
                  "key": "type",
                  "value": "audio/webm",
                  "type": "text"
                },
                {
                  "key": "message",
                  "value": "Voice message",
                  "type": "text"
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/chat/message/upload",
              "host": ["{{base_url}}"],
              "path": ["chat", "message", "upload"]
            },
            "description": "Send a voice recording message"
          }
        },
        {
          "name": "Get Messages",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/chat/message?conversation_id={{conversation_id}}&limit=20",
              "host": ["{{base_url}}"],
              "path": ["chat", "message"],
              "query": [
                {
                  "key": "conversation_id",
                  "value": "{{conversation_id}}"
                },
                {
                  "key": "limit",
                  "value": "20"
                },
                {
                  "key": "cursor",
                  "value": "",
                  "description": "Optional: message ID for pagination"
                }
              ]
            },
            "description": "Get messages in a conversation with pagination"
          },
          "response": [
            {
              "name": "Success Response",
              "originalRequest": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{base_url}}/chat/message?conversation_id=cmfnrg40s0001ihlwhr6lefab&limit=20",
                  "host": ["{{base_url}}"],
                  "path": ["chat", "message"],
                  "query": [
                    {
                      "key": "conversation_id",
                      "value": "cmfnrg40s0001ihlwhr6lefab"
                    },
                    {
                      "key": "limit",
                      "value": "20"
                    }
                  ]
                }
              },
              "status": "OK",
              "code": 200,
              "_postman_previewlanguage": "json",
              "header": [
                {
                  "key": "Content-Type",
                  "value": "application/json"
                }
              ],
              "cookie": [],
              "body": "{\n  \"success\": true,\n  \"data\": [\n    {\n      \"id\": \"msg_123\",\n      \"message\": \"Hello! Ready to start working on this job?\",\n      \"created_at\": \"2025-09-17T09:10:00.000Z\",\n      \"status\": \"SENT\",\n      \"sender\": {\n        \"id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n        \"name\": \"John Doe\",\n        \"avatar\": \"avatar1.jpg\",\n        \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar1.jpg\"\n      },\n      \"receiver\": {\n        \"id\": \"cmfg9trmy0002ihd8ifha67n2\",\n        \"name\": \"Jane Helper\",\n        \"avatar\": \"avatar2.jpg\",\n        \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar2.jpg\"\n      },\n      \"attachment\": null\n    },\n    {\n      \"id\": \"msg_124\",\n      \"message\": \"Here's the reference image for the job\",\n      \"created_at\": \"2025-09-17T09:15:30.000Z\",\n      \"status\": \"SENT\",\n      \"sender\": {\n        \"id\": \"cmfmgajnj0000ihq0zjovmzp1\",\n        \"name\": \"John Doe\",\n        \"avatar\": \"avatar1.jpg\",\n        \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar1.jpg\"\n      },\n      \"receiver\": {\n        \"id\": \"cmfg9trmy0002ihd8ifha67n2\",\n        \"name\": \"Jane Helper\",\n        \"avatar\": \"avatar2.jpg\",\n        \"avatar_url\": \"http://localhost:3000/public/storage/avatar/avatar2.jpg\"\n      },\n      \"attachment\": {\n        \"id\": \"att_456\",\n        \"name\": \"screenshot.jpg\",\n        \"type\": \"image/jpeg\",\n        \"size\": 1024000,\n        \"file\": \"abc123_screenshot.jpg\",\n        \"file_url\": \"http://localhost:3000/public/storage/attachment/abc123_screenshot.jpg\"\n      }\n    }\n  ]\n}"
            }
          ]
        }
      ]
    }
  ]
}

